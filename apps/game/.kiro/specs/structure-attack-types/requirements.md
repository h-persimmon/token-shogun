# 要件書

## 概要

タワーディフェンスゲームにおいて、Structure（砲台）が2種類の攻撃タイプを持てるようにする機能です。砲台のような着弾位置を定めて一定時間後に着弾する範囲攻撃と、弓矢のような必中攻撃の2種類を実装します。

## 要件

### 要件1

**ユーザーストーリー:** プレイヤーとして、砲台が着弾位置を予測して範囲攻撃できるようにしたい。そうすることで、敵の移動を予測した戦略的な攻撃が可能になる。

#### 受け入れ基準

1. WHEN Structureが砲台攻撃タイプに設定されている THEN システムは敵の現在位置と移動方向から着弾予測位置を計算する SHALL
2. WHEN 砲台攻撃が発動される THEN システムは予測位置に向けて弾丸を発射し、一定時間後に着弾する SHALL
3. WHEN 弾丸が着弾する THEN システムは着弾位置の範囲内にいる全ての敵にダメージを与える SHALL
4. IF 敵が着弾時に範囲外に移動している THEN その敵はダメージを受けない SHALL

### 要件2

**ユーザーストーリー:** プレイヤーとして、弓矢タイプの攻撃で確実に敵を攻撃したい。そうすることで、確実にダメージを与えられる防御手段を持てる。

#### 受け入れ基準

1. WHEN Structureが弓矢攻撃タイプに設定されている THEN システムは対象の敵に向けて弾丸を発射する SHALL
2. WHEN 弓矢攻撃が発動される THEN システムは対象敵の現在位置を追跡し続ける SHALL
3. WHEN 弾丸が敵に到達する THEN システムは対象敵に必ずダメージを与える SHALL
4. IF 対象敵が攻撃中に倒される THEN 弾丸は消失する SHALL

### 要件3

**ユーザーストーリー:** 開発者として、AttackComponentで攻撃タイプを設定できるようにしたい。そうすることで、異なる攻撃特性を持つStructureを作成できる。

#### 受け入れ基準

1. WHEN AttackComponentを作成する THEN システムは攻撃タイプ（砲台/弓矢）を指定できる SHALL
2. WHEN AttackComponentを作成する THEN システムは砲台攻撃の場合、着弾時間と範囲を設定できる SHALL
3. WHEN AttackComponentを作成する THEN システムは弾丸の移動速度を設定できる SHALL
4. WHEN AttackComponentを作成する THEN システムは攻撃力を設定できる SHALL

### 要件4

**ユーザーストーリー:** 開発者として、AttackSystemで時間差範囲攻撃を処理したい。そうすることで、複数の弾丸と着弾タイミングを効率的に管理できる。

#### 受け入れ基準

1. WHEN AttackSystemが更新される THEN システムは飛行中の全ての弾丸の位置を更新する SHALL
2. WHEN 砲台弾丸の着弾時間になる THEN システムは着弾位置の範囲内の敵を検索する SHALL
3. WHEN 弓矢弾丸が対象に到達する THEN システムは対象敵にダメージを適用する SHALL
4. WHEN 弾丸が着弾または命中する THEN システムは弾丸をObjectPoolに返却する SHALL

### 要件5

**ユーザーストーリー:** プレイヤーとして、攻撃の視覚的フィードバックを得たい。そうすることで、攻撃の効果と範囲を理解できる。

#### 受け入れ基準

1. WHEN 砲台攻撃が発射される THEN システムは弾丸の軌道を表示する SHALL
2. WHEN 砲台弾丸が着弾する THEN システムは着弾位置に爆発エフェクトを表示する SHALL
3. WHEN 弓矢攻撃が発射される THEN システムは弾丸が対象を追跡する軌道を表示する SHALL
4. WHEN 攻撃がダメージを与える THEN システムは被ダメージエフェクトを表示する SHALL